<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: devOps | codemachine]]></title>
  <link href="http://ivanbrennan.github.io/blog/categories/devops/atom.xml" rel="self"/>
  <link href="http://ivanbrennan.github.io/"/>
  <updated>2017-06-03T13:31:34-04:00</updated>
  <id>http://ivanbrennan.github.io/</id>
  <author>
    <name><![CDATA[Ivan Brennan]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Chef roles]]></title>
    <link href="http://ivanbrennan.github.io/blog/2013/11/21/chef-roles/"/>
    <updated>2013-11-21T09:11:00-05:00</updated>
    <id>http://ivanbrennan.github.io/blog/2013/11/21/chef-roles</id>
    <content type="html"><![CDATA[<p>It took me a while to wrap my head around a Chef role. It sounds simple enough at first &mdash; a collection of recipes that allows a node to act in a certain capacity, as say, a Redis server &mdash; but Chef also deals in cookbooks, which are also collections of recipes. So then what&rsquo;s the difference between a cookbook and a role?</p>

<p>A cookbook is a collection of recipes relating to a particular piece of technology. The nginx cookbook, for example, contains several recipes related to building and configuring nginx: <code>nginx::source</code> builds nginx from source, <code>nginx::ohai_plugin</code> provides the Ohai plugin as a template, <code>nginx::passenger</code> builds the passenger gem, etc.</p>

<p>A node is a single server, and Chef can apply a variety of recipes to the node to set it up as needed. Those recipes can be selected from a variety of cookbooks, and we don&rsquo;t have to use every recipe in a given cookbook. So how do we package the particular mix of recipes we need for a certain type of node? In a role.</p>

<p>For lack of a better analogy, you could think of a role as a multi-course meal made from several recipes pulled from a variety of cookbooks. A couple from a Pasta cookbook, one from a French Cuisine cookbook, one from a Pastries cookbook. The meal won&rsquo;t be made from every single recipe in those books, just the desired ones.</p>

<p>Recipes can include each other too, like mixins in Ruby (the <code>nginx::source</code> recipe, for example, includes the <code>nginx::ohai_plugin</code> recipe as part of it) but let&rsquo;s not add to the confusion just yet.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[sandboxing chef-solo]]></title>
    <link href="http://ivanbrennan.github.io/blog/2013/11/19/sandboxing-chef-solo/"/>
    <updated>2013-11-19T22:31:00-05:00</updated>
    <id>http://ivanbrennan.github.io/blog/2013/11/19/sandboxing-chef-solo</id>
    <content type="html"><![CDATA[<p>I&rsquo;m in the early stages of a team project. Our goal is to build a rails app that uses <a href="http://docs.opscode.com/chef_solo.html">chef-solo</a> to automate the creation and provisioning of a DigitalOcean droplet, and deploys to it using <a href="https://github.com/capistrano/capistrano">Capistrano</a>. The idea is to let a user deploy their own app to a <a href="http://digitalocean.com/">DO</a> server using our app to do the heavy lifting.</p>

<p>We&rsquo;re new to chef-solo, and initially I tried plowing through documentation, hoping to build a comprehensive understanding before diving into the project. But we really needed to get our hands dirty to get a feel for chef, so we started sandboxing tiny prototypes. We were flying blind at times, but the small successes kept us moving forward.</p>

<p>The zeroth step was to install some necessary tools, namely knife-solo and berkshelf. knife-solo is the command line tool for chef-solo, and berkshelf plays a role similar to Bundler, managing dependencies within chef.</p>

<p>For our first sandbox venture, we took an existing, chef-ready <a href="https://github.com/TalkingQuickly/rails-server-template">rails server template</a> and used it to provision an existing server.</p>

<p>Next we created a project directory from scratch, initialized a chef repo within it, and cloned an existing cookbook into the cookbooks directory. Easier said than done, but the ascii-art made it all worth while.</p>

<p><img class="production <a" src="href="http://i.imgur.com/gEGr6LJ.jpg">http://i.imgur.com/gEGr6LJ.jpg</a>" title="&lsquo;production&rsquo; &lsquo;production&rsquo;" ></p>

<p>These little exercises were helpful, but we were still bogged down trying to map out the components and configurations encompassed by Chef. We backed up, got some helpful input from the TA&rsquo;s here at Flatiron School, and started mapping out the components necessary to <em>our</em> project, pinpointing the core functionality we needed to start with.</p>

<p><img class="sketch <a" src="href="http://i.imgur.com/oih6feU.jpg">http://i.imgur.com/oih6feU.jpg</a>" title="&lsquo;sketch&rsquo; &lsquo;sketch&rsquo;" ></p>

<h3>Step 1: Get a local chef repo communicating with DigitalOcean</h3>

<p>It turns out there&rsquo;s a plugin just for that: <a href="https://github.com/rmoriz/knife-digital_ocean">knife-digital_ocean</a>. We had to put our API-credentials from DigitalOcean into <code>knife.rb</code>, a configuration file for chef-solo, and add our SSH key to the DO account. Then we were able to create a new DO droplet with the desired OS and our SSH key, all in a single console command. Thank you knife-digital_ocean!</p>

<p>There&rsquo;s plenty more work ahead. Our rails app needs to:</p>

<ul>
<li>automate knife-digital_ocean commands</li>
<li>take user input

<ul>
<li>Github url for the app they want to deploy</li>
<li>necessary credentials (handle the SSH keys)</li>
</ul>
</li>
<li>run provisioning as a background process (it takes a while)</li>
<li>deploy with Capistrano</li>
</ul>


<p>It feels much more manageable with step 1 behind us and the skeleton of the project sketched out. Still, I&rsquo;m sure I&rsquo;ll be spending some more quality time in the Chef documentation.</p>
]]></content>
  </entry>
  
</feed>
